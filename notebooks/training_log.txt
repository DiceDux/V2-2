2025-05-23 21:39:17,779 - INFO - شروع آموزش مدل CatBoost Pro...
2025-05-23 21:39:17,779 - INFO - پردازش موازی داده‌های نمادها...
2025-05-23 21:39:17,809 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:17,809 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:17,810 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:17,810 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:17,907 - INFO - تعداد ردیف‌های داده برای DOGEUSDT: 1000
2025-05-23 21:39:17,908 - INFO - شروع استخراج فیچرها برای DOGEUSDT...
2025-05-23 21:39:17,909 - INFO - شروع استخراج فیچر. df shape: (1000, 7)
2025-05-23 21:39:17,919 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:17,930 - INFO - تعداد ردیف‌های داده برای SOLUSDT: 1000
2025-05-23 21:39:17,931 - INFO - شروع استخراج فیچرها برای SOLUSDT...
2025-05-23 21:39:17,933 - INFO - شروع استخراج فیچر. df shape: (1000, 7)
2025-05-23 21:39:17,943 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:17,963 - INFO - تعداد ردیف‌های داده برای BTCUSDT: 1000
2025-05-23 21:39:17,964 - INFO - شروع استخراج فیچرها برای BTCUSDT...
2025-05-23 21:39:17,964 - INFO - شروع استخراج فیچر. df shape: (1000, 7)
2025-05-23 21:39:17,973 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:17,977 - INFO - تعداد ردیف‌های داده برای ETHUSDT: 1000
2025-05-23 21:39:17,978 - INFO - شروع استخراج فیچرها برای ETHUSDT...
2025-05-23 21:39:17,979 - INFO - شروع استخراج فیچر. df shape: (1000, 7)
2025-05-23 21:39:17,988 - INFO - Engine دیتابیس با موفقیت ایجاد شد.
2025-05-23 21:39:21,153 - WARNING - هیچ داده‌ای برای SOL در بازه 1739577600 تا 1744761600 یافت نشد.
2025-05-23 21:39:21,158 - WARNING - هیچ داده‌ای برای SOL در بازه 1739563200 تا 1744747200 یافت نشد.
2025-05-23 21:39:21,163 - WARNING - هیچ داده‌ای برای SOL در بازه 1739548800 تا 1744732800 یافت نشد.
2025-05-23 21:39:21,170 - WARNING - هیچ داده‌ای برای SOL در بازه 1739534400 تا 1744718400 یافت نشد.
....
2025-05-23 21:39:23,528 - WARNING - هیچ داده‌ای برای BTC در بازه 1736337600 تا 1741521600 یافت نشد.
2025-05-23 21:39:23,537 - WARNING - هیچ داده‌ای برای BTC در بازه 1736323200 تا 1741507200 یافت نشد.
2025-05-23 21:39:23,548 - WARNING - هیچ داده‌ای برای BTC در بازه 1736308800 تا 1741492800 یافت نشد.
2025-05-23 21:39:23,556 - WARNING - هیچ داده‌ای برای BTC در بازه 1736294400 تا 1741478400 یافت نشد.
2025-05-23 21:39:23,562 - WARNING - هیچ داده‌ای برای BTC در بازه 1736280000 تا 1741464000 یافت نشد.
2025-05-23 21:39:25,708 - INFO - START calculate_technical_features
2025-05-23 21:39:25,733 - INFO - تبدیل دیتافریم به Polars...
2025-05-23 21:39:25,745 - INFO - تبدیل نوع داده‌های ستون‌ها به Float64...
2025-05-23 21:39:25,779 - INFO - محاسبه ATR
2025-05-23 21:39:25,793 - INFO - START calculate_technical_features
2025-05-23 21:39:25,817 - INFO - تبدیل دیتافریم به Polars...
2025-05-23 21:39:25,826 - INFO - تبدیل نوع داده‌های ستون‌ها به Float64...
2025-05-23 21:39:25,873 - INFO - محاسبه ATR
2025-05-23 21:39:26,427 - INFO - پایان محاسبه فیچرها. کلیدهای features:
2025-05-23 21:39:26,541 - INFO - پایان محاسبه فیچرها. کلیدهای features:
2025-05-23 21:39:28,978 - INFO - START calculate_technical_features
2025-05-23 21:39:29,077 - INFO - تبدیل دیتافریم به Polars...
2025-05-23 21:39:29,105 - INFO - تبدیل نوع داده‌های ستون‌ها به Float64...
2025-05-23 21:39:29,137 - INFO - محاسبه ATR
2025-05-23 21:39:30,384 - INFO - پایان محاسبه فیچرها. کلیدهای features:
2025-05-23 21:39:30,415 - INFO - START calculate_technical_features
2025-05-23 21:39:30,594 - INFO - تبدیل دیتافریم به Polars...
2025-05-23 21:39:30,669 - INFO - تبدیل نوع داده‌های ستون‌ها به Float64...
2025-05-23 21:39:30,933 - INFO - محاسبه ATR
2025-05-23 21:39:32,540 - INFO - پایان محاسبه فیچرها. کلیدهای features:
2025-05-23 21:43:00,350 - WARNING - هیچ داده‌ای برای SOL در بازه 1739577600 تا 1744761600 یافت نشد.
2025-05-23 21:43:00,350 - WARNING - هیچ داده‌ای برای SOL در بازه 1739563200 تا 1744747200 یافت نشد.
2025-05-23 21:43:00,377 - WARNING - خبر غیرمرتبط برای SOL: no_news_available...
2025-05-23 21:43:00,427 - WARNING - خبر غیرمرتبط برای SOL: no_news_available...
2025-05-23 21:43:00,456 - WARNING - هیچ داده‌ای برای SOL در بازه 1739548800 تا 1744732800 یافت نشد.
2025-05-23 21:43:00,486 - WARNING - هیچ داده‌ای برای SOL در بازه 1739534400 تا 1744718400 یافت نشد.
2025-05-23 21:43:00,489 - WARNING - خبر غیرمرتبط برای SOL: no_news_available...
2025-05-23 21:43:00,543 - WARNING - خبر غیرمرتبط برای SOL: no_news_available...
2025-05-23 21:43:00,631 - WARNING - هیچ داده‌ای برای SOL در بازه 1739520000 تا 1744704000 یافت نشد.
...
2025-05-23 21:43:27,389 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,432 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,476 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,692 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,755 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,783 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,838 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,887 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:27,974 - WARNING - هیچ داده‌ای برای BTC در بازه 1736280000 تا 1741464000 یافت نشد.
2025-05-23 21:43:27,990 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:28,002 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:28,070 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:28,193 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:28,275 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:28,607 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:28,610 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:43:29,210 - WARNING - خبر غیرمرتبط برای BTC: no_news_available...
2025-05-23 21:46:22,424 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:36,173 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:39,829 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:39,892 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:42,204 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:42,220 - INFO - پایان استخراج فیچر. result_df shape: (1000, 124)
2025-05-23 21:46:42,251 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:42,470 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:42,517 - ERROR - خطا در get_batch_sentiments برای SOLUSDT: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 973, in get_batch_sentiments
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:42,673 - WARNING - فیچر btc_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:42,689 - WARNING - فیچر usdt_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:42,704 - INFO - فیچرها برای SOLUSDT استخراج شدند: (1000, 129)
2025-05-23 21:46:44,079 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:48,704 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:48,720 - INFO - پایان استخراج فیچر. result_df shape: (1000, 124)
2025-05-23 21:46:48,736 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:48,798 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:48,845 - ERROR - خطا در get_batch_sentiments برای DOGEUSDT: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 973, in get_batch_sentiments
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:49,017 - WARNING - فیچر btc_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:49,033 - WARNING - فیچر usdt_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:49,048 - INFO - فیچرها برای DOGEUSDT استخراج شدند: (1000, 129)
2025-05-23 21:46:49,720 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:49,736 - INFO - پایان استخراج فیچر. result_df shape: (1000, 124)
2025-05-23 21:46:49,736 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:49,767 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:49,783 - ERROR - خطا در get_batch_sentiments برای ETHUSDT: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 973, in get_batch_sentiments
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:49,892 - WARNING - فیچر btc_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:49,908 - WARNING - فیچر usdt_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:49,923 - INFO - فیچرها برای ETHUSDT استخراج شدند: (1000, 129)
2025-05-23 21:46:49,923 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:49,939 - INFO - پایان استخراج فیچر. result_df shape: (1000, 124)
2025-05-23 21:46:49,970 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:49,986 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:50,006 - ERROR - خطا در get_batch_indices: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 933, in get_batch_indices
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:50,022 - ERROR - خطا در get_batch_sentiments برای BTCUSDT: List argument must consist only of tuples or dictionaries
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\data\data_manager.py", line 973, in get_batch_sentiments
    df = pd.read_sql(query, conn, params=params)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 734, in read_sql
    return pandas_sql.read_query(
           ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1836, in read_query
    result = self.execute(sql, params)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\io\sql.py", line 1659, in execute
    return self.con.exec_driver_sql(sql, *args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py", line 1769, in exec_driver_sql
    distilled_parameters = _distill_raw_params(parameters)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 44, in sqlalchemy.cyextension.util._distill_raw_params
  File "lib\\sqlalchemy\\cyextension\\util.pyx", line 23, in sqlalchemy.cyextension.util._check_item
sqlalchemy.exc.ArgumentError: List argument must consist only of tuples or dictionaries
2025-05-23 21:46:50,131 - WARNING - فیچر btc_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:50,147 - WARNING - فیچر usdt_dominance غایب بود، با 0.0 پر شد.
2025-05-23 21:46:50,147 - INFO - فیچرها برای BTCUSDT استخراج شدند: (1000, 129)
2025-05-23 21:46:50,481 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:50,997 - ERROR - خطا در بررسی ستون‌های دیتابیس: 'Connection' object has no attribute 'cursor'
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\feature_engineering_full_ultra_v2.py", line 170, in generate_sql_query
    with conn.cursor() as cursor:
         ^^^^^^^^^^^
AttributeError: 'Connection' object has no attribute 'cursor'
2025-05-23 21:46:54,294 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:54,310 - INFO - فیچرها برای SOLUSDT در دیتابیس ذخیره شدند.
2025-05-23 21:46:54,325 - INFO - شروع لیبل‌گذاری داده‌ها...
2025-05-23 21:46:54,341 - INFO - لیبل‌گذاری داده‌ها انجام شد.
2025-05-23 21:46:54,356 - INFO - لیبل‌گذاری برای SOLUSDT انجام شد: (1000, 131)
2025-05-23 21:46:58,794 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:58,794 - INFO - فیچرها برای DOGEUSDT در دیتابیس ذخیره شدند.
2025-05-23 21:46:58,810 - INFO - شروع لیبل‌گذاری داده‌ها...
2025-05-23 21:46:58,825 - INFO - لیبل‌گذاری داده‌ها انجام شد.
2025-05-23 21:46:58,825 - INFO - لیبل‌گذاری برای DOGEUSDT انجام شد: (1000, 131)
2025-05-23 21:46:59,091 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:59,091 - INFO - فیچرها برای ETHUSDT در دیتابیس ذخیره شدند.
2025-05-23 21:46:59,091 - INFO - شروع لیبل‌گذاری داده‌ها...
2025-05-23 21:46:59,091 - INFO - لیبل‌گذاری داده‌ها انجام شد.
2025-05-23 21:46:59,091 - INFO - لیبل‌گذاری برای ETHUSDT انجام شد: (1000, 131)
2025-05-23 21:46:59,356 - INFO - فیچرها با موفقیت در دیتابیس ذخیره شدند. تعداد: 1000
2025-05-23 21:46:59,356 - INFO - فیچرها برای BTCUSDT در دیتابیس ذخیره شدند.
2025-05-23 21:46:59,372 - INFO - شروع لیبل‌گذاری داده‌ها...
2025-05-23 21:46:59,372 - INFO - لیبل‌گذاری داده‌ها انجام شد.
2025-05-23 21:46:59,372 - INFO - لیبل‌گذاری برای BTCUSDT انجام شد: (1000, 131)
2025-05-23 21:46:59,372 - INFO - ترکیب داده‌های تمام نمادها...
2025-05-23 21:46:59,388 - INFO - داده‌های نهایی ساخته شدند: (4000, 131)
2025-05-23 21:47:07,035 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:07,035 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:07,035 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:07,035 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:07,035 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
...
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - WARNING - هیچ فیچری برای ذخیره ارسال نشده است.
2025-05-23 21:47:10,426 - INFO - فیچرهای ترید در دیتابیس ذخیره شدند.
2025-05-23 21:47:10,426 - INFO - چک کردن وجود ستون‌های امبدینگ...
2025-05-23 21:47:10,442 - INFO - آماده‌سازی امبدینگ‌های خبری...
2025-05-23 21:47:10,457 - INFO - جایگزینی مقادیر پرت...
2025-05-23 21:47:10,457 - ERROR - خطا در مدیریت پرت‌ها: 'volume_score'
2025-05-23 21:47:10,457 - ERROR - خطا در اجرای فرآیند آموزش: "['volume_score', 'fundamental_score', 'news_score', 'funding_rate'] not in index"
Traceback (most recent call last):
  File "C:\Users\Administrator\Desktop\V2-2\train_ai_model_multi_advanced.py", line 458, in main
    X = df_final[technical_features + fundamental_features + trade_features_list + embedding_features]
        ~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
  File "C:\Users\Administrator\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexes\base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['volume_score', 'fundamental_score', 'news_score', 'funding_rate'] not in index"
